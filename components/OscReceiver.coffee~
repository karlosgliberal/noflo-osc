noflo = require "noflo"
chai = require "chai"
osc = require "omgosc"

class OscReceiver extends noflo.LoggingComponent
  constructor: ->
    @ip = null
    @port = null
    
    @msg = null
    
    @receiver = new osc.UdpSender(@port, @ip)
    @receiver.on 'message', (message) => @gotMessage
    
    @inPorts =
      ip: new noflo.Port
      port: new noflo.Port
    @outPorts =
      msg: new noflo.Port

    @inPorts.ip.on 'data', (data) =>
      @ip = data
    @inPorts.port.on 'data', (data) =>
      @port = data
  #  @inPorts.msg.on 'data', (data) =>
    #  @msg = data
     # do @mensaje unless @msg is null

    @sendLog
      logLevel: "info"
      message: ""
      request: @ip

  gotMessage: (message) ->
   
    @outPorts.salida.send @msg
    @outPorts.salida.disconnect()

exports.getComponent = -> new OscSend

